<!-- Project 9: Add a new function to your ToDos app that initially loads ToDos data from an API.

Requirements:
-Watch the video above to learn a bit more about APIs and how to get started using Axios, which you'll need for this project.
-Create a new Git BRANCH, and make the updates for Project 9 in this branch. Keep Project 8 in the initial branch (main/master).
-Update the ToDos app from the previous project to initially load the localStorage of ToDos by fetching the ToDos resources in the JSONPlaceholder API using Axios, NOT the "fetch" example that's in the JSONPlaceholder API documentation.
-To help you understand what the endpoints/urls for the JSONPlaceholder return, click the "todos" in the "Resources" to see the structure of the data: an array of todo objects (key/value pairs).
-Use the Axios API. On the page load, if the Todos array is empty, load it with the Todos from this API. Otherwise, if it's not empty, it should load what's currently stored.
-Send me the project for review and get started on the next project.

Links:
https://jsonplaceholder.typicode.com/
https://github.com/axios/axios
https://attacomsian.com/blog/axios-javascript -->

<!DOCTYPE html>

<html>

<head>
  <meta charset="utf-8"> <!-- BOOTSTRAP -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script> <!-- JAVASCRIPT -->
  <title>ToDo App Using Axios</title>
</head>

<body>
  <div class="container-fluid m-3">
    <div class="row">
      <h3 class="display-4">ToDo</h3>
    </div>
    <div class="row">
      <div class="col-sm-2">
        <input type="text" id="item" class="mb-1"><br>
        <button class="btn-primary btn-sm mt-1" onclick="addItem()">Add item</button>
      </div>
      <div class="col-sm-2">
        <h6 class="text-muted mt-2">Items</h6>
        <ul id="list-items"></ul>
        <button class="btn-danger btn-sm" onclick="removeItem()">Remove item</button>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script>
    // localStorage.clear();


    let list = JSON.parse(localStorage.getItem('list')) || [];
    let listOfItems = document.getElementById("list-items");


    const renderList = (list, title) => {
      let listOfItems = document.getElementById("list-items");
      listOfItems.innerHTML = "";

      if (!Array.isArray(list) || !list.length) {
        axios.get('https://jsonplaceholder.typicode.com/todos?_limit=2')
          .then(response => {
            let list = response.data;
            localStorage.setItem("list", JSON.stringify(list));
          })
          .catch(error => console.log(error))
      }

      list.map(({title, id}) => {
        let li = document.createElement("li");
        let deleteBox = document.createElement("input");

        deleteBox.type = "checkbox";
        deleteBox.className = "mx-1 delete-box form-check-input";
        li.setAttribute("id", id);
        li.className = "item";
        li.appendChild(document.createTextNode(title));
        li.appendChild(deleteBox);
        listOfItems.appendChild(li);
      })
    }

    renderList(list);


    function addItem() {
      let inputValue = document.getElementById("item").value;
      let inputId = Date.now();

      if (inputValue === "") {
        alert("Enter a text item to add to the list.");
        return false;
      } else {
        list.push({title: inputValue, id: inputId});
        localStorage.setItem("list", JSON.stringify(list));
        }

      renderList(list, inputValue);
      document.getElementById("item").value = "";
    }


    function removeItem() {
      let checkboxes = document.getElementsByClassName("delete-box");
      let items = document.getElementsByClassName("item");

      for (let i = 0; i < checkboxes.length; i++) {
        if (checkboxes[i].checked) {
          checkboxes[i].parentNode.removeChild(checkboxes[i]);
          items[i].parentNode.removeChild(items[i]);
          list.splice([i], 1);
          localStorage.setItem("list", JSON.stringify(list));
        }
      }
    }

  </script>
</body>

</html>
